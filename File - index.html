<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Attendance Calculator</title>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
</head>
<body class="bg-indigo-50">

    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;
        
        // Icons component wrapper since we are using CDN
        const Icon = ({ name, className }) => {
            useEffect(() => {
                lucide.createIcons();
            }, [name]);
            return <i data-lucide={name} className={className}></i>;
        };

        function App() {
            const [totalClasses, setTotalClasses] = useState('');
            const [attendedClasses, setAttendedClasses] = useState('');
            const [targetPercentage, setTargetPercentage] = useState(75);
            const [result, setResult] = useState(null);
            const [error, setError] = useState('');

            useEffect(() => {
                calculateAttendance();
            }, [totalClasses, attendedClasses, targetPercentage]);

            const calculateAttendance = () => {
                setError('');
                const total = parseInt(totalClasses);
                const attended = parseInt(attendedClasses);
                const target = parseInt(targetPercentage);

                if (!totalClasses || !attendedClasses) { setResult(null); return; }
                if (isNaN(total) || isNaN(attended)) { setResult(null); return; }

                if (total <= 0) { setError("Total classes must be > 0."); setResult(null); return; }
                if (attended < 0) { setError("Attended classes cannot be negative."); setResult(null); return; }
                if (attended > total) { setError("Attended > Total is not possible."); setResult(null); return; }

                const currentPercent = (attended / total) * 100;
                
                let calculationResult = {
                    currentPercent: currentPercent,
                    isSafe: currentPercent >= target,
                    classesToAttend: 0,
                    classesToBunk: 0,
                    impossible: false
                };

                if (currentPercent < target) {
                    if (target >= 100) {
                        calculationResult.impossible = true;
                    } else {
                        const numerator = (target * total) - (100 * attended);
                        const denominator = 100 - target;
                        calculationResult.classesToAttend = Math.ceil(numerator / denominator);
                    }
                } else {
                    if (target === 0) {
                        calculationResult.classesToBunk = 9999; 
                    } else {
                        const maxTotal = attended / (target / 100);
                        calculationResult.classesToBunk = Math.floor(maxTotal - total);
                    }
                }
                setResult(calculationResult);
                setTimeout(() => lucide.createIcons(), 100); // Refresh icons
            };

            const handleReset = () => {
                setTotalClasses('');
                setAttendedClasses('');
                setTargetPercentage(75);
                setResult(null);
                setError('');
            };

            return (
                <div className="min-h-screen bg-gradient-to-br from-indigo-50 to-blue-100 flex items-center justify-center p-4 font-sans text-slate-800">
                    <div className="max-w-md w-full bg-white rounded-3xl shadow-xl overflow-hidden border border-white/50">
                        <div className="bg-indigo-600 p-6 text-white text-center">
                            <div className="mx-auto bg-white/20 w-12 h-12 rounded-full flex items-center justify-center mb-3 backdrop-blur-sm">
                                <Icon name="calculator" className="w-6 h-6 text-white" />
                            </div>
                            <h1 className="text-2xl font-bold">Attendance Calculator</h1>
                            <p className="text-indigo-100 text-sm mt-1">Check your eligibility instantly</p>
                        </div>

                        <div className="p-6 space-y-6">
                            <div className="space-y-4">
                                <div className="relative">
                                    <label className="block text-sm font-medium text-gray-700 mb-1 ml-1">Total Classes Held</label>
                                    <div className="relative">
                                        <div className="absolute left-3 top-3"><Icon name="book-open" className="text-gray-400 w-5 h-5" /></div>
                                        <input type="number" min="1" value={totalClasses} onChange={(e) => setTotalClasses(e.target.value)} placeholder="e.g. 120" className="w-full pl-10 pr-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:ring-2 focus:ring-indigo-500 outline-none" />
                                    </div>
                                </div>

                                <div className="relative">
                                    <label className="block text-sm font-medium text-gray-700 mb-1 ml-1">Classes Attended</label>
                                    <div className="relative">
                                        <div className="absolute left-3 top-3"><Icon name="user-check" className="text-gray-400 w-5 h-5" /></div>
                                        <input type="number" min="0" value={attendedClasses} onChange={(e) => setAttendedClasses(e.target.value)} placeholder="e.g. 85" className="w-full pl-10 pr-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:ring-2 focus:ring-indigo-500 outline-none" />
                                    </div>
                                </div>

                                <div className="pt-2">
                                    <div className="flex justify-between items-center mb-2">
                                        <label className="text-sm font-medium text-gray-700 ml-1">Target: <span className="text-indigo-600 font-bold">{targetPercentage}%</span></label>
                                    </div>
                                    <input type="range" min="1" max="100" value={targetPercentage} onChange={(e) => setTargetPercentage(e.target.value)} className="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-indigo-600" />
                                </div>
                            </div>

                            {error && (
                                <div className="bg-red-50 text-red-600 p-3 rounded-xl flex items-center gap-2 text-sm animate-pulse">
                                    <Icon name="alert-triangle" className="w-4 h-4" /> {error}
                                </div>
                            )}

                            {result && !error && (
                                <div className={`rounded-2xl p-6 text-center transform transition-all duration-300 ${result.isSafe ? 'bg-green-50 border-2 border-green-100' : 'bg-red-50 border-2 border-red-100'}`}>
                                    <div className="mb-2 text-gray-600 font-medium uppercase tracking-wide text-xs">Current Status</div>
                                    <div className={`text-5xl font-extrabold mb-4 ${result.isSafe ? 'text-green-600' : 'text-red-600'}`}>{result.currentPercent.toFixed(2)}%</div>
                                    <div className="space-y-3">
                                        {result.isSafe ? (
                                            <>
                                                <div className="flex items-center justify-center gap-2 text-green-700 font-bold text-lg"><Icon name="check-circle" className="w-6 h-6" /> On Track!</div>
                                                <p className="text-green-800/80">You can bunk <span className="bg-green-200 px-2 py-0.5 rounded text-green-800 font-bold">{result.classesToBunk}</span> more classes.</p>
                                            </>
                                        ) : (
                                            <>
                                                <div className="flex items-center justify-center gap-2 text-red-700 font-bold text-lg"><Icon name="alert-triangle" className="w-6 h-6" /> Attendance Low!</div>
                                                {result.impossible ? <p className="text-red-800/80">Impossible to reach target.</p> : 
                                                <p className="text-red-800/80">Attend <span className="bg-red-200 px-2 py-0.5 rounded text-red-800 font-bold">{result.classesToAttend}</span> more classes consecutively.</p>}
                                            </>
                                        )}
                                    </div>
                                </div>
                            )}

                            <button onClick={handleReset} className="w-full py-3 px-4 bg-gray-100 hover:bg-gray-200 text-gray-600 font-semibold rounded-xl flex items-center justify-center gap-2 transition-colors">
                                <Icon name="rotate-ccw" className="w-4 h-4" /> Reset Calculator
                            </button>
                        </div>
                    </div>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>